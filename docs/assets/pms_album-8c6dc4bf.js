import{_ as U,E as s,r as f,o as u,c as I,a as l,V as q,w as o,e as C,b as g,g as K,O as L}from"./index-cb4e48ca.js";import{E as M}from"./el-overlay-1d94b4c5.js";import{a as j,b as F,E as O}from"./el-form-item-f6b9e70c.js";import{E as R}from"./el-pagination-8d11a77d.js";import{a as _,E as G,b as H}from"./index-d20eb06a.js";import{E as J}from"./index-b083c78e.js";import{E as x}from"./index-3ec6997f.js";import{E as Q}from"./index-c18ef027.js";import"./index-ee84b82c.js";let E;const b=()=>{E=J.service({lock:!0,text:"加载中...",spinner:"wave"})},y=()=>{E&&E.close()},W=async t=>{b();try{return await _.request({url:"/mall/pms-album/one/"+t,method:"get"})}catch(e){throw e}finally{y()}},X=async t=>{b();try{return await _.request({url:"/mall/pms-album/del/"+t,method:"get"})}catch(e){throw e}finally{y()}},Y=async t=>{b();try{return await _.request({url:"/mall/pms-album/edit",method:"post",data:t})}catch(e){throw e}finally{y()}},Z=async t=>{b();try{return await _.request({url:"/mall/pms-album/add",method:"post",data:t})}catch(e){throw e}finally{y()}},$=async t=>{b();try{return await _.request({url:"/mall/pms-album/page",method:"post",data:t})}catch(e){throw e}finally{y()}},V={One:W,Del:X,Edit:Y,Add:Z,Page:$},ee="/21ums/assets/iphone-687577ef.png";const te={data(){return{json:{current:1,size:99},searchText:"",currentPage:1,pageSize:6,total:0,tableData:[],editDialogVisible:!1,editItem:{},selectedRow:null}},computed:{paginatedData(){const t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.filteredtableData.slice(t,e)},filteredtableData(){return this.searchText?this.tableData.filter(t=>String(t.id).includes(String(this.searchText))):this.tableData}},methods:{openEditDialog(t){this.editItem={...t},this.editDialogVisible=!0},handlePageChange(t){this.currentPage=t},saveEdit(){console.log(this.editItem),x.confirm("确定修改吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=this.tableData.findIndex(e=>e.id===this.editItem.id);t!==-1?this.tableData.splice(t,1,this.editItem):this.tableData.push(this.editItem),this.editDialogVisible=!1,s.success("修改成功！"),this.editItem={}}).catch(()=>{s.info("修改取消！")})},fetchData(){V.Page(this.json).then(t=>{this.tableData=t.data.data.page.records||t.data.records,console.log(t),s.success("刷新成功！")}).catch(t=>{s.error("刷新失败，请检查网络！"),console.error("Error fetching data:",t)})},Insert(t){V.Add(t).then(e=>{delete t.isNew,s.success("插入数据成功！")}).catch(e=>{s.error("插入数据失败！"),console.error("保存修改失败:",e)})},Alter(t){V.Edit(t).then(e=>{console.log("修改保存成功:",e.data),s.success("修改数据成功！")}).catch(e=>{s.error("修改数据失败！"),console.error("保存修改失败:",e)})},Del(t){x.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{V.Del(t.id).then(e=>{const h=this.tableData.findIndex(k=>k.id===t.id);h!==-1&&this.tableData.splice(h,1),console.log("删除成功:",e.data),s.success("删除成功！")}).catch(e=>{s.error(response.msg),console.error("删除失败:",e)})}).catch(()=>{})},delND(t){x.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=this.tableData.findIndex(h=>h.id===t.id);e!==-1&&this.tableData.splice(e,1),s.success("删除成功！")}).catch(()=>{s.error("删除失败！"),console.log("取消删除 API",t)})},addAPI(){s.success("添加数据ing");const t={coverPic:"",description:"",id:0,name:"",picCount:0,sort:0,isNew:"true"};this.tableData.push(t);const e=Math.ceil(this.tableData.length/this.pageSize);this.handlePageChange(e)}},created(){this.fetchData()}},le={class:"root"},ne=["src"],oe={key:1,src:ee,alt:"图标",width:"140",height:"140"},ae={slot:"footer"};function se(t,e,h,k,a,i){const c=j,d=H,v=f("Position"),m=L,r=Q,w=f("Upload"),z=f("Edit"),P=f("Delete"),T=G,B=R,p=F,N=O,A=M,S=f("Plus");return u(),I("div",le,[l(c,{modelValue:a.searchText,"onUpdate:modelValue":e[0]||(e[0]=n=>a.searchText=n),placeholder:"请输入搜索关键字",clearable:"",onClear:t.clearSearch,onKeyup:q(t.performSearch,["enter"]),style:{"margin-bottom":"20px"}},null,8,["modelValue","onClear","onKeyup"]),l(T,{data:i.paginatedData,"header-cell-style":{background:"#eef1f6",color:"#606266",textAlign:"center"},borde:"","header-align":"center","cell-style":{textAlign:"center"}},{default:o(()=>[l(d,{prop:"id",label:"编号"}),l(d,{prop:"name",label:"名称"}),l(d,{prop:"coverPic",label:"图片"},{default:o(({row:n})=>[isNaN(Number(n.coverPic,10))?(u(),I("img",{key:0,src:n.coverPic,alt:"图标",width:"30",height:"30"},null,8,ne)):(u(),I("img",oe))]),_:1}),l(d,{prop:"picCount",label:"数量"}),l(d,{prop:"sort",label:"分类"}),l(d,{prop:"description",label:"描述"}),l(d,{width:"150rpx",label:"操作"},{default:o(({row:n})=>[n.isNew?(u(),C(r,{key:0,size:"mini",class:"custom-button",type:"success",circle:"",onClick:D=>i.Insert(n)},{default:o(()=>[l(m,null,{default:o(()=>[l(v)]),_:1})]),_:2},1032,["onClick"])):(u(),C(r,{key:1,class:"custom-button",size:"mini",type:"warning",onClick:D=>i.Alter(n),style:{margin:"5px"}},{default:o(()=>[g("上传 "),l(m,null,{default:o(()=>[l(w)]),_:1})]),_:2},1032,["onClick"])),l(r,{type:"primary",size:"mini",onClick:D=>i.openEditDialog(n),style:{margin:"5px"}},{default:o(()=>[g("修改 "),l(m,null,{default:o(()=>[l(z)]),_:1})]),_:2},1032,["onClick"]),n.isNew?(u(),C(r,{key:2,size:"mini",type:"danger",circle:"",onClick:D=>i.delND(n)},{default:o(()=>[l(m,null,{default:o(()=>[l(P)]),_:1})]),_:2},1032,["onClick"])):(u(),C(r,{key:3,type:"danger",size:"mini",onClick:D=>i.Del(n),style:{margin:"5px"}},{default:o(()=>[g("删除 "),l(m,null,{default:o(()=>[l(P)]),_:1})]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"]),l(B,{"current-page":a.currentPage,"page-size":a.pageSize,total:i.filteredtableData.length,onCurrentChange:i.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"]),l(A,{class:"form",modelValue:a.editDialogVisible,"onUpdate:modelValue":e[8]||(e[8]=n=>a.editDialogVisible=n),onClose:e[9]||(e[9]=n=>a.editDialogVisible=!1)},{default:o(()=>[l(N,null,{default:o(()=>[l(p,{label:"编号："},{default:o(()=>[l(c,{modelValue:a.editItem.id,"onUpdate:modelValue":e[1]||(e[1]=n=>a.editItem.id=n),type:"number",onKeypress:"return(/^[0-9]*$/.test(String.fromCharCode(event.keyCode)))"},null,8,["modelValue"])]),_:1}),l(p,{label:"名称："},{default:o(()=>[l(c,{modelValue:a.editItem.name,"onUpdate:modelValue":e[2]||(e[2]=n=>a.editItem.name=n)},null,8,["modelValue"])]),_:1}),l(p,{label:"图片："},{default:o(()=>[l(c,{modelValue:a.editItem.coverPic,"onUpdate:modelValue":e[3]||(e[3]=n=>a.editItem.coverPic=n),disabled:""},null,8,["modelValue"])]),_:1}),l(p,{label:"数量："},{default:o(()=>[l(c,{modelValue:a.editItem.picCount,"onUpdate:modelValue":e[4]||(e[4]=n=>a.editItem.picCount=n)},null,8,["modelValue"])]),_:1}),l(p,{label:"分类："},{default:o(()=>[l(c,{modelValue:a.editItem.sort,"onUpdate:modelValue":e[5]||(e[5]=n=>a.editItem.sort=n)},null,8,["modelValue"])]),_:1}),l(p,{label:"描述："},{default:o(()=>[l(c,{modelValue:a.editItem.description,"onUpdate:modelValue":e[6]||(e[6]=n=>a.editItem.description=n)},null,8,["modelValue"])]),_:1})]),_:1}),K("div",ae,[l(r,{onClick:e[7]||(e[7]=n=>a.editDialogVisible=!1)},{default:o(()=>[g("取消")]),_:1}),l(r,{type:"primary",onClick:i.saveEdit},{default:o(()=>[g("保存")]),_:1},8,["onClick"])])]),_:1},8,["modelValue"]),l(r,{type:"primary",size:"large",onClick:i.addAPI,style:{"margin-top":"20px","margin-left":"50%"}},{default:o(()=>[g("添加 "),l(m,null,{default:o(()=>[l(S)]),_:1})]),_:1},8,["onClick"])])}const fe=U(te,[["render",se]]);export{fe as default};
