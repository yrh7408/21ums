import{_ as T,E as i,r as y,o as g,c as B,a as t,V as N,w as o,e as P,g as U,b as k,O as q}from"./index-f2ea6133.js";import{E as F}from"./el-overlay-ad8ea762.js";import{a as K,b as L,E as M}from"./el-form-item-66b1a363.js";import{E as j}from"./el-pagination-4fad5470.js";import{a as f,E as R,b as G}from"./index-ed8c00ce.js";import{E as H}from"./index-76b37135.js";import{E as V}from"./index-0d75bc99.js";import{E as J}from"./index-40b7cd74.js";import"./index-b6ac6e26.js";let I;const h=()=>{I=H.service({lock:!0,text:"加载中...",spinner:"wave"})},_=()=>{I&&I.close()},Q=async l=>{h();try{return await f.request({url:"/mall/ums-member-rule-setting/one/"+l,method:"get"})}catch(e){throw e}finally{_()}},W=async l=>{h();try{return await f.request({url:"/mall/ums-member-rule-setting/del/"+l,method:"get"})}catch(e){throw e}finally{_()}},X=async l=>{h();try{return await f.request({url:"/mall/ums-member-rule-setting/edit",method:"post",data:l})}catch(e){throw e}finally{_()}},Y=async l=>{h();try{return await f.request({url:"/mall/ums-member-rule-setting/add",method:"post",data:l})}catch(e){throw e}finally{_()}},Z=async l=>{h();try{return await f.request({url:"/mall/ums-member-rule-setting/page",method:"post",data:l})}catch(e){throw e}finally{_()}},D={One:Q,Del:W,Edit:X,Add:Y,Page:Z};const $={data(){return{json:{current:1,size:99},searchText:"",currentPage:1,pageSize:6,total:0,tableData:[],editDialogVisible:!1,editItem:{},selectedRow:null}},computed:{paginatedData(){const l=(this.currentPage-1)*this.pageSize,e=l+this.pageSize;return this.filteredtableData.slice(l,e)},filteredtableData(){return this.searchText&&this.tableData&&this.tableData.length>0?this.tableData.filter(l=>String(l.name).includes(String(this.searchText))):this.tableData||[]}},methods:{openEditDialog(l){this.editItem={...l},this.editDialogVisible=!0},handlePageChange(l){this.currentPage=l},saveEdit(){console.log(this.editItem),V.confirm("确定修改吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const l=this.tableData.findIndex(e=>e.id===this.editItem.id);l!==-1?this.tableData.splice(l,1,this.editItem):this.tableData.push(this.editItem),this.editDialogVisible=!1,i.success("修改成功！"),this.editItem={}}).catch(()=>{i.info("修改取消！")})},fetchData(){D.Page(this.json).then(l=>{this.tableData=l.data.data.page.records||l.data.records,console.log(this.tableData),i.success("刷新成功！")}).catch(l=>{i.error("刷新失败，请检查网络！"),console.error("Error fetching data:",l)})},Insert(l){D.Add(l).then(e=>{delete l.isNew,i.success("插入数据成功！")}).catch(e=>{i.error("插入数据失败！"),console.error("保存修改失败:",e)})},Alter(l){D.Edit(l).then(e=>{console.log("修改保存成功:",e.data),i.success("修改数据成功！")}).catch(e=>{i.error("修改数据失败！"),console.error("保存修改失败:",e)})},Del(l){V.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D.Del(l.id).then(e=>{const p=this.tableData.findIndex(x=>x.id===l.id);p!==-1&&this.tableData.splice(p,1),console.log("删除成功:",e.data),i.success("删除成功！")}).catch(e=>{i.error(response.msg),console.error("删除失败:",e)})}).catch(()=>{})},delND(l){V.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=this.tableData.findIndex(p=>p.id===l.id);e!==-1&&this.tableData.splice(e,1),i.success("删除成功！")}).catch(()=>{i.error("删除失败！"),console.log("取消删除 API",l)})},addAPI(){i.success("添加数据ing");const l={consumePerPoint:0,continueSignDay:0,continueSignPoint:0,id:0,lowOrderAmount:0,maxPointPerOrder:0,type:0,isNew:!0};this.tableData.push(l);const e=Math.ceil(this.tableData.length/this.pageSize);this.handlePageChange(e)}},created(){this.fetchData()}},ee={class:"root"},te={slot:"footer"};function le(l,e,p,x,a,r){const s=K,d=G,C=y("Position"),m=q,c=J,w=y("EditPen"),E=y("Delete"),S=R,v=j,u=L,z=M,A=F,O=y("CirclePlusFilled");return g(),B("div",ee,[t(s,{modelValue:a.searchText,"onUpdate:modelValue":e[0]||(e[0]=n=>a.searchText=n),placeholder:"请输入搜索关键字",clearable:"",onClear:l.clearSearch,onKeyup:N(l.performSearch,["enter"]),style:{"margin-bottom":"20px"}},null,8,["modelValue","onClear","onKeyup"]),t(S,{data:r.paginatedData,"header-cell-style":{background:"#eef1f6",color:"#606266"},borde:""},{default:o(()=>[t(d,{prop:"id",label:"id"}),t(d,{prop:"consumePerPoint",label:"consumePerPoint"}),t(d,{prop:"continueSignDay",label:"continueSignDay"}),t(d,{prop:"continueSignPoint",label:"continueSignPoint"}),t(d,{prop:"lowOrderAmount",label:"lowOrderAmount"}),t(d,{prop:"maxPointPerOrder",label:"maxPointPerOrder"}),t(d,{prop:"type",label:"type"}),t(d,{width:"150rpx",label:"操作"},{default:o(({row:n})=>[n.isNew?(g(),P(c,{key:0,size:"mini",class:"custom-button",type:"success",circle:"",onClick:b=>r.Insert(n)},{default:o(()=>[t(m,null,{default:o(()=>[t(C)]),_:1})]),_:2},1032,["onClick"])):(g(),P(c,{key:1,class:"custom-button",size:"mini",type:"warning",circle:"",onClick:b=>r.Alter(n)},{default:o(()=>[t(m,null,{default:o(()=>[t(C)]),_:1})]),_:2},1032,["onClick"])),t(c,{type:"primary",size:"mini",circle:"",onClick:b=>r.openEditDialog(n)},{default:o(()=>[t(m,null,{default:o(()=>[t(w)]),_:1})]),_:2},1032,["onClick"]),n.isNew?(g(),P(c,{key:2,size:"mini",type:"danger",circle:"",onClick:b=>r.delND(n)},{default:o(()=>[t(m,null,{default:o(()=>[t(E)]),_:1})]),_:2},1032,["onClick"])):(g(),P(c,{key:3,type:"danger",size:"mini",circle:"",onClick:b=>r.Del(n)},{default:o(()=>[t(m,null,{default:o(()=>[t(E)]),_:1})]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"]),t(v,{"current-page":a.currentPage,"page-size":a.pageSize,total:r.filteredtableData.length,onCurrentChange:r.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"]),t(A,{class:"form",modelValue:a.editDialogVisible,"onUpdate:modelValue":e[9]||(e[9]=n=>a.editDialogVisible=n),onClose:e[10]||(e[10]=n=>a.editDialogVisible=!1)},{default:o(()=>[t(z,null,{default:o(()=>[t(u,{label:"id",disabled:""},{default:o(()=>[t(s,{modelValue:a.editItem.id,"onUpdate:modelValue":e[1]||(e[1]=n=>a.editItem.id=n)},null,8,["modelValue"])]),_:1}),t(u,{label:"consumePerPoint"},{default:o(()=>[t(s,{modelValue:a.editItem.consumePerPoint,"onUpdate:modelValue":e[2]||(e[2]=n=>a.editItem.consumePerPoint=n)},null,8,["modelValue"])]),_:1}),t(u,{label:"continueSignDay"},{default:o(()=>[t(s,{modelValue:a.editItem.continueSignDay,"onUpdate:modelValue":e[3]||(e[3]=n=>a.editItem.continueSignDay=n)},null,8,["modelValue"])]),_:1}),t(u,{label:"continueSignPoint"},{default:o(()=>[t(s,{modelValue:a.editItem.continueSignPoint,"onUpdate:modelValue":e[4]||(e[4]=n=>a.editItem.continueSignPoint=n)},null,8,["modelValue"])]),_:1}),t(u,{label:"lowOrderAmount"},{default:o(()=>[t(s,{modelValue:a.editItem.lowOrderAmount,"onUpdate:modelValue":e[5]||(e[5]=n=>a.editItem.lowOrderAmount=n)},null,8,["modelValue"])]),_:1}),t(u,{label:"maxPointPerOrder"},{default:o(()=>[t(s,{modelValue:a.editItem.maxPointPerOrder,"onUpdate:modelValue":e[6]||(e[6]=n=>a.editItem.maxPointPerOrder=n)},null,8,["modelValue"])]),_:1}),t(u,{label:"type"},{default:o(()=>[t(s,{modelValue:a.editItem.type,"onUpdate:modelValue":e[7]||(e[7]=n=>a.editItem.type=n)},null,8,["modelValue"])]),_:1})]),_:1}),U("div",te,[t(c,{onClick:e[8]||(e[8]=n=>a.editDialogVisible=!1)},{default:o(()=>[k("取消")]),_:1}),t(c,{type:"primary",onClick:r.saveEdit},{default:o(()=>[k("保存")]),_:1},8,["onClick"])])]),_:1},8,["modelValue"]),t(c,{type:"primary",circle:"",size:"large",onClick:r.addAPI,style:{"margin-top":"20px","margin-left":"50%"}},{default:o(()=>[t(m,null,{default:o(()=>[t(O)]),_:1})]),_:1},8,["onClick"])])}const me=T($,[["render",le]]);export{me as default};
