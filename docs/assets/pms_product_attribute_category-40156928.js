import{_ as S,E as i,r as y,o as p,c as A,a,V as U,w as l,e as C,g as q,b as P,O as F}from"./index-cb4e48ca.js";import{E as K}from"./el-overlay-1d94b4c5.js";import{a as L,b as M,E as j}from"./el-form-item-f6b9e70c.js";import{E as O}from"./el-pagination-8d11a77d.js";import{a as g,E as R,b as G}from"./index-d20eb06a.js";import{E as H}from"./index-b083c78e.js";import{E}from"./index-3ec6997f.js";import{E as J}from"./index-c18ef027.js";import"./index-ee84b82c.js";let I;const h=()=>{I=H.service({lock:!0,text:"加载中...",spinner:"wave"})},f=()=>{I&&I.close()},Q=async t=>{h();try{return await g.request({url:"/mall/pms-product-attribute-category/one/"+t,method:"get"})}catch(e){throw e}finally{f()}},W=async t=>{h();try{return await g.request({url:"/mall/pms-product-attribute-category/del/"+t,method:"get"})}catch(e){throw e}finally{f()}},X=async t=>{h();try{return await g.request({url:"/mall/pms-product-attribute-category/edit",method:"post",data:t})}catch(e){throw e}finally{f()}},Y=async t=>{h();try{return await g.request({url:"/mall/pms-product-attribute-category/add",method:"post",data:t})}catch(e){throw e}finally{f()}},Z=async t=>{h();try{return await g.request({url:"/mall/pms-product-attribute-category/page",method:"post",data:t})}catch(e){throw e}finally{f()}},D={One:Q,Del:W,Edit:X,Add:Y,Page:Z};const $={data(){return{json:{current:1,size:99},searchText:"",currentPage:1,pageSize:6,total:0,tableData:[],editDialogVisible:!1,editItem:{},selectedRow:null}},computed:{paginatedData(){const t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.filteredtableData.slice(t,e)},filteredtableData(){return this.searchText?this.tableData.filter(t=>String(t.id).includes(String(this.searchText))):this.tableData}},methods:{openEditDialog(t){this.editItem={...t},this.editDialogVisible=!0},handlePageChange(t){this.currentPage=t},saveEdit(){console.log(this.editItem),E.confirm("确定修改吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=this.tableData.findIndex(e=>e.id===this.editItem.id);t!==-1?this.tableData.splice(t,1,this.editItem):this.tableData.push(this.editItem),this.editDialogVisible=!1,i.success("修改成功！"),this.editItem={}}).catch(()=>{i.info("修改取消！")})},fetchData(){D.Page(this.json).then(t=>{this.tableData=t.data.data.page.records||t.data.records,console.log(t),i.success("刷新成功！")}).catch(t=>{i.error("刷新失败，请检查网络！"),console.error("Error fetching data:",t)})},Insert(t){D.Add(t).then(e=>{delete t.isNew,i.success("插入数据成功！")}).catch(e=>{i.error("插入数据失败！"),console.error("保存修改失败:",e)})},Alter(t){D.Edit(t).then(e=>{console.log("修改保存成功:",e.data),i.success("修改数据成功！")}).catch(e=>{i.error("修改数据失败！"),console.error("保存修改失败:",e)})},Del(t){E.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D.Del(t.id).then(e=>{const d=this.tableData.findIndex(V=>V.id===t.id);d!==-1&&this.tableData.splice(d,1),console.log("删除成功:",e.data),i.success("删除成功！")}).catch(e=>{i.error(response.msg),console.error("删除失败:",e)})}).catch(()=>{})},delND(t){E.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=this.tableData.findIndex(d=>d.id===t.id);e!==-1&&this.tableData.splice(e,1),i.success("删除成功！")}).catch(()=>{i.error("删除失败！"),console.log("取消删除 API",t)})},addAPI(){i.success("添加数据ing");const t={attributeCount:0,id:0,name:"",paramCount:0,isNew:!0};this.tableData.push(t);const e=Math.ceil(this.tableData.length/this.pageSize);this.handlePageChange(e)}},created(){this.fetchData()}},ee={class:"root"},te={slot:"footer"};function ae(t,e,d,V,o,r){const u=L,m=G,x=y("Position"),c=F,s=J,w=y("EditPen"),k=y("Delete"),v=R,z=O,_=M,T=j,B=K,N=y("CirclePlusFilled");return p(),A("div",ee,[a(u,{modelValue:o.searchText,"onUpdate:modelValue":e[0]||(e[0]=n=>o.searchText=n),placeholder:"请输入搜索关键字",clearable:"",onClear:t.clearSearch,onKeyup:U(t.performSearch,["enter"]),style:{"margin-bottom":"20px"}},null,8,["modelValue","onClear","onKeyup"]),a(v,{data:r.paginatedData,"header-cell-style":{background:"#eef1f6",color:"#606266"},borde:""},{default:l(()=>[a(m,{prop:"id",label:"id"}),a(m,{prop:"attributeCount",label:"attributeCount"}),a(m,{prop:"name",label:"name"}),a(m,{prop:"paramCount",label:"paramCount"}),a(m,{width:"150rpx",label:"操作"},{default:l(({row:n})=>[n.isNew?(p(),C(s,{key:0,size:"mini",class:"custom-button",type:"success",circle:"",onClick:b=>r.Insert(n)},{default:l(()=>[a(c,null,{default:l(()=>[a(x)]),_:1})]),_:2},1032,["onClick"])):(p(),C(s,{key:1,class:"custom-button",size:"mini",type:"warning",circle:"",onClick:b=>r.Alter(n)},{default:l(()=>[a(c,null,{default:l(()=>[a(x)]),_:1})]),_:2},1032,["onClick"])),a(s,{type:"primary",size:"mini",circle:"",onClick:b=>r.openEditDialog(n)},{default:l(()=>[a(c,null,{default:l(()=>[a(w)]),_:1})]),_:2},1032,["onClick"]),n.isNew?(p(),C(s,{key:2,size:"mini",type:"danger",circle:"",onClick:b=>r.delND(n)},{default:l(()=>[a(c,null,{default:l(()=>[a(k)]),_:1})]),_:2},1032,["onClick"])):(p(),C(s,{key:3,type:"danger",size:"mini",circle:"",onClick:b=>r.Del(n)},{default:l(()=>[a(c,null,{default:l(()=>[a(k)]),_:1})]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"]),a(z,{"current-page":o.currentPage,"page-size":o.pageSize,total:r.filteredtableData.length,onCurrentChange:r.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"]),a(B,{class:"form",modelValue:o.editDialogVisible,"onUpdate:modelValue":e[6]||(e[6]=n=>o.editDialogVisible=n),onClose:e[7]||(e[7]=n=>o.editDialogVisible=!1)},{default:l(()=>[a(T,null,{default:l(()=>[a(_,{label:"id"},{default:l(()=>[a(u,{modelValue:o.editItem.id,"onUpdate:modelValue":e[1]||(e[1]=n=>o.editItem.id=n),disabled:""},null,8,["modelValue"])]),_:1}),a(_,{label:"attributeCount"},{default:l(()=>[a(u,{modelValue:o.editItem.attributeCount,"onUpdate:modelValue":e[2]||(e[2]=n=>o.editItem.attributeCount=n)},null,8,["modelValue"])]),_:1}),a(_,{label:"name"},{default:l(()=>[a(u,{modelValue:o.editItem.name,"onUpdate:modelValue":e[3]||(e[3]=n=>o.editItem.name=n)},null,8,["modelValue"])]),_:1}),a(_,{label:"paramCount"},{default:l(()=>[a(u,{modelValue:o.editItem.paramCount,"onUpdate:modelValue":e[4]||(e[4]=n=>o.editItem.paramCount=n)},null,8,["modelValue"])]),_:1})]),_:1}),q("div",te,[a(s,{onClick:e[5]||(e[5]=n=>o.editDialogVisible=!1)},{default:l(()=>[P("取消")]),_:1}),a(s,{type:"primary",onClick:r.saveEdit},{default:l(()=>[P("保存")]),_:1},8,["onClick"])])]),_:1},8,["modelValue"]),a(s,{type:"primary",circle:"",size:"large",onClick:r.addAPI,style:{"margin-top":"20px","margin-left":"50%"}},{default:l(()=>[a(c,null,{default:l(()=>[a(N)]),_:1})]),_:1},8,["onClick"])])}const me=S($,[["render",ae]]);export{me as default};
