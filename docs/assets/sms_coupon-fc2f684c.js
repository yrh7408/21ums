import{_ as N,E as d,r as I,o as b,c as S,a as t,V as A,w as i,e as _,g as q,b as E,O as F}from"./index-f2ea6133.js";import{E as K}from"./el-overlay-ad8ea762.js";import{a as M,b as j,E as O}from"./el-form-item-66b1a363.js";import{E as R}from"./el-input-number-9b50dcb6.js";import{E as G}from"./el-pagination-4fad5470.js";import{a as f,E as H,b as J}from"./index-ed8c00ce.js";import{E as Q}from"./index-76b37135.js";import{E as C}from"./index-0d75bc99.js";import{E as W}from"./index-40b7cd74.js";import"./index-b6ac6e26.js";let x;const g=()=>{x=Q.service({lock:!0,text:"加载中...",spinner:"wave"})},h=()=>{x&&x.close()},X=async n=>{g();try{return await f.request({url:"/mall/sms-coupon/one"+n,method:"get"})}catch(e){throw e}finally{h()}},Y=async n=>{g();try{return await f.request({url:"/mall/sms-coupon/del/"+n,method:"get"})}catch(e){throw e}finally{h()}},Z=async n=>{g();try{return await f.request({url:"/mall/sms-coupon/edit",method:"post",data:n})}catch(e){throw e}finally{h()}},$=async n=>{g();try{return await f.request({url:"/mall/sms-coupon/add",method:"post",data:n})}catch(e){throw e}finally{h()}},ee=async n=>{g();try{return await f.request({url:"/mall/sms-coupon/page",method:"post",data:n})}catch(e){throw e}finally{h()}},y={One:X,Del:Y,Edit:Z,Add:$,Page:ee};const te={data(){return{json:{current:1,size:99},searchText:"",currentPage:1,pageSize:6,total:0,tableData:[],editDialogVisible:!1,editItem:{},selectedRow:null}},computed:{paginatedData(){const n=(this.currentPage-1)*this.pageSize,e=n+this.pageSize;return this.filteredtableData.slice(n,e)},filteredtableData(){return this.searchText?this.tableData.filter(n=>String(n.id).includes(String(this.searchText))):this.tableData}},methods:{openEditDialog(n){this.editItem={...n},this.editDialogVisible=!0},handlePageChange(n){this.currentPage=n},saveEdit(){console.log(this.editItem),C.confirm("确定修改吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const n=this.tableData.findIndex(e=>e.id===this.editItem.id);n!==-1?this.tableData.splice(n,1,this.editItem):this.tableData.push(this.editItem),this.editDialogVisible=!1,d.success("修改成功！"),this.editItem={}}).catch(()=>{d.info("修改取消！")})},fetchData(){y.Page(this.json).then(n=>{this.tableData=n.data.data.page.records||n.data.records,d.success("刷新成功！")}).catch(n=>{d.error("刷新失败，请检查网络！")})},Insert(n){y.Add(n).then(e=>{delete n.isNew,d.success("插入数据成功！")}).catch(e=>{d.error("插入数据失败！"),console.error("保存修改失败:",e)})},Alter(n){y.Edit(n).then(e=>{console.log("修改保存成功:",e.data),d.success("修改数据成功！")}).catch(e=>{d.error("修改数据失败！"),console.error("保存修改失败:",e)})},Del(n){C.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{y.Del(n.id).then(e=>{const c=this.tableData.findIndex(D=>D.id===n.id);c!==-1&&this.tableData.splice(c,1),console.log("删除成功:",e.data),d.success("删除成功！")}).catch(e=>{d.error(response.msg),console.error("删除失败:",e)})}).catch(()=>{})},delND(n){C.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=this.tableData.findIndex(c=>c.id===n.id);e!==-1&&this.tableData.splice(e,1),d.success("删除成功！")}).catch(()=>{d.error("删除失败！"),console.log("取消删除 API",n)})},addAPI(){d.success("添加数据ing");const n={amount:0,code:"",count:0,enableTime:"",endTime:"",id:0,memberLevel:0,minPoint:0,name:"",note:"",perLimit:0,platform:0,publishCount:0,receiveCount:0,startTime:"",type:0,useCount:0,useType:0,isNew:!0};this.tableData.push(n);const e=Math.ceil(this.tableData.length/this.pageSize);this.handlePageChange(e)}},created(){this.fetchData()}},le={class:"root"};function oe(n,e,c,D,o,u){const r=M,a=J,T=I("Position"),p=F,m=W,v=I("EditPen"),w=I("Delete"),P=H,k=G,s=j,U=R,L=O,z=K,B=I("CirclePlusFilled");return b(),S("div",le,[t(r,{modelValue:o.searchText,"onUpdate:modelValue":e[0]||(e[0]=l=>o.searchText=l),placeholder:"请输入搜索关键字",clearable:"",onClear:n.clearSearch,onKeyup:A(n.performSearch,["enter"]),style:{"margin-bottom":"20px"}},null,8,["modelValue","onClear","onKeyup"]),t(P,{data:u.paginatedData,"header-cell-style":{background:"#eef1f6",color:"#606266"},borde:""},{default:i(()=>[t(a,{width:"60rpx",prop:"id",label:"id"}),t(a,{width:"100rpx",prop:"name",label:"name"}),t(a,{width:"100rpx",prop:"amount",label:"amount"}),t(a,{width:"100rpx",prop:"code",label:"code"}),t(a,{width:"100rpx",prop:"count",label:"count"}),t(a,{width:"100rpx",prop:"enableTime",label:"enableTime"}),t(a,{width:"100rpx",prop:"endTime",label:"endTime"}),t(a,{width:"100rpx",prop:"memberLevel",label:"memberLevel"}),t(a,{prop:"minPoint",label:"minPoint"}),t(a,{prop:"note",label:"note"}),t(a,{prop:"perLimit",label:"perLimit"}),t(a,{width:"100rpx",prop:"platform",label:"platform"}),t(a,{width:"100rpx",prop:"publishCount",label:"publishCount"}),t(a,{width:"100rpx",prop:"receiveCount",label:"receiveCount"}),t(a,{width:"100rpx",prop:"startTime",label:"startTime"}),t(a,{width:"100rpx",prop:"type",label:"type"}),t(a,{width:"100rpx",prop:"useCount",label:"useCount"}),t(a,{width:"100rpx",prop:"useType",label:"useType"}),t(a,{width:"150rpx",label:"操作"},{default:i(({row:l})=>[l.isNew?(b(),_(m,{key:0,size:"mini",class:"custom-button",type:"success",circle:"",onClick:V=>u.Insert(l)},{default:i(()=>[t(p,null,{default:i(()=>[t(T)]),_:1})]),_:2},1032,["onClick"])):(b(),_(m,{key:1,class:"custom-button",size:"mini",type:"warning",circle:"",onClick:V=>u.Alter(l)},{default:i(()=>[t(p,null,{default:i(()=>[t(T)]),_:1})]),_:2},1032,["onClick"])),t(m,{type:"primary",size:"mini",circle:"",onClick:V=>u.openEditDialog(l)},{default:i(()=>[t(p,null,{default:i(()=>[t(v)]),_:1})]),_:2},1032,["onClick"]),l.isNew?(b(),_(m,{key:2,size:"mini",type:"danger",circle:"",onClick:V=>u.delND(l)},{default:i(()=>[t(p,null,{default:i(()=>[t(w)]),_:1})]),_:2},1032,["onClick"])):(b(),_(m,{key:3,type:"danger",size:"mini",circle:"",onClick:V=>u.Del(l)},{default:i(()=>[t(p,null,{default:i(()=>[t(w)]),_:1})]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"]),t(k,{"current-page":o.currentPage,"page-size":o.pageSize,total:u.filteredtableData.length,onCurrentChange:u.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"]),t(z,{class:"form",modelValue:o.editDialogVisible,"onUpdate:modelValue":e[19]||(e[19]=l=>o.editDialogVisible=l),onClose:e[20]||(e[20]=l=>o.editDialogVisible=!1)},{default:i(()=>[t(L,null,{default:i(()=>[t(s,{label:"id"},{default:i(()=>[t(r,{modelValue:o.editItem.id,"onUpdate:modelValue":e[1]||(e[1]=l=>o.editItem.id=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"name"},{default:i(()=>[t(r,{modelValue:o.editItem.name,"onUpdate:modelValue":e[2]||(e[2]=l=>o.editItem.name=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"amount"},{default:i(()=>[t(U,{vcmodel:"editItem.amount"})]),_:1}),t(s,{label:"code"},{default:i(()=>[t(r,{modelValue:o.editItem.code,"onUpdate:modelValue":e[3]||(e[3]=l=>o.editItem.code=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"count"},{default:i(()=>[t(r,{modelValue:o.editItem.count,"onUpdate:modelValue":e[4]||(e[4]=l=>o.editItem.count=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"enableTime"},{default:i(()=>[t(r,{modelValue:o.editItem.enableTime,"onUpdate:modelValue":e[5]||(e[5]=l=>o.editItem.enableTime=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"endTime"},{default:i(()=>[t(r,{modelValue:o.editItem.endTime,"onUpdate:modelValue":e[6]||(e[6]=l=>o.editItem.endTime=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"memberLevel"},{default:i(()=>[t(r,{modelValue:o.editItem.memberLevel,"onUpdate:modelValue":e[7]||(e[7]=l=>o.editItem.memberLevel=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"minPoint"},{default:i(()=>[t(r,{modelValue:o.editItem.minPoint,"onUpdate:modelValue":e[8]||(e[8]=l=>o.editItem.minPoint=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"note"},{default:i(()=>[t(r,{modelValue:o.editItem.note,"onUpdate:modelValue":e[9]||(e[9]=l=>o.editItem.note=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"perLimit"},{default:i(()=>[t(r,{modelValue:o.editItem.perLimit,"onUpdate:modelValue":e[10]||(e[10]=l=>o.editItem.perLimit=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"platform"},{default:i(()=>[t(r,{modelValue:o.editItem.platform,"onUpdate:modelValue":e[11]||(e[11]=l=>o.editItem.platform=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"publishCount"},{default:i(()=>[t(r,{modelValue:o.editItem.publishCount,"onUpdate:modelValue":e[12]||(e[12]=l=>o.editItem.publishCount=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"receiveCount"},{default:i(()=>[t(r,{modelValue:o.editItem.receiveCount,"onUpdate:modelValue":e[13]||(e[13]=l=>o.editItem.receiveCount=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"startTime"},{default:i(()=>[t(r,{modelValue:o.editItem.startTime,"onUpdate:modelValue":e[14]||(e[14]=l=>o.editItem.startTime=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"type"},{default:i(()=>[t(r,{modelValue:o.editItem.type,"onUpdate:modelValue":e[15]||(e[15]=l=>o.editItem.type=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"useCount"},{default:i(()=>[t(r,{modelValue:o.editItem.useCount,"onUpdate:modelValue":e[16]||(e[16]=l=>o.editItem.useCount=l)},null,8,["modelValue"])]),_:1}),t(s,{label:"useType"},{default:i(()=>[t(r,{modelValue:o.editItem.useType,"onUpdate:modelValue":e[17]||(e[17]=l=>o.editItem.useType=l)},null,8,["modelValue"])]),_:1})]),_:1}),q("div",null,[t(m,{onClick:e[18]||(e[18]=l=>o.editDialogVisible=!1)},{default:i(()=>[E("取消")]),_:1}),t(m,{type:"primary",onClick:u.saveEdit},{default:i(()=>[E("保存")]),_:1},8,["onClick"])])]),_:1},8,["modelValue"]),t(m,{type:"primary",circle:"",size:"large",onClick:u.addAPI,style:{"margin-top":"20px","margin-left":"50%"}},{default:i(()=>[t(p,null,{default:i(()=>[t(B)]),_:1})]),_:1},8,["onClick"])])}const be=N(te,[["render",oe]]);export{be as default};
