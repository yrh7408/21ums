import{_ as A,E as a,r as I,o as h,c as U,a as l,V as q,w as n,e as y,g as F,b as T,O as K}from"./index-f2ea6133.js";import{E as L}from"./el-overlay-ad8ea762.js";import{a as M,b as j,E as O}from"./el-form-item-66b1a363.js";import{E as R}from"./el-input-number-9b50dcb6.js";import{E as G}from"./el-pagination-4fad5470.js";import{a as f,E as H,b as J}from"./index-ed8c00ce.js";import{E as Q}from"./index-76b37135.js";import{E as V}from"./index-0d75bc99.js";import{E as W}from"./index-40b7cd74.js";import"./index-b6ac6e26.js";let E;const b=()=>{E=Q.service({lock:!0,text:"加载中...",spinner:"wave"})},g=()=>{E&&E.close()},X=async t=>{b();try{return await f.request({url:"/mall/sms-flash-promotion-session/one/"+t,method:"get"})}catch(e){throw e}finally{g()}},Y=async t=>{b();try{return await f.request({url:"/mall/sms-flash-promotion-session/del/"+t,method:"get"})}catch(e){throw e}finally{g()}},Z=async t=>{b();try{return await f.request({url:"/mall/sms-flash-promotion-session/edit",method:"post",data:t})}catch(e){throw e}finally{g()}},$=async t=>{b();try{return await f.request({url:"/mall/sms-flash-promotion-session/add",method:"post",data:t})}catch(e){throw e}finally{g()}},ee=async t=>{b();try{return await f.request({url:"/mall/sms-flash-promotion-session/page",method:"post",data:t})}catch(e){throw e}finally{g()}},D={One:X,Del:Y,Edit:Z,Add:$,Page:ee};const te={data(){return{json:{current:1,size:99},searchText:"",currentPage:1,pageSize:6,total:0,tableData:[],editDialogVisible:!1,editItem:{},selectedRow:null}},computed:{paginatedData(){const t=(this.currentPage-1)*this.pageSize,e=t+this.pageSize;return this.filteredtableData.slice(t,e)},filteredtableData(){return this.searchText?this.tableData.filter(t=>String(t.id).includes(String(this.searchText))):this.tableData}},methods:{openEditDialog(t){this.editItem={...t},this.editDialogVisible=!0},handlePageChange(t){this.currentPage=t},saveEdit(){console.log(this.editItem),V.confirm("确定修改吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const t=this.tableData.findIndex(e=>e.id===this.editItem.id);t!==-1?this.tableData.splice(t,1,this.editItem):this.tableData.push(this.editItem),this.editDialogVisible=!1,a.success("修改成功！"),this.editItem={}}).catch(()=>{a.info("修改取消！")})},fetchData(){D.Page(this.json).then(t=>{this.tableData=t.data.data.page.records||t.data.records,console.log(t),a.success("刷新成功！")}).catch(t=>{a.error("刷新失败，请检查网络！"),console.error("Error fetching data:",t)})},Insert(t){D.Add(t).then(e=>{delete t.isNew,a.success("插入数据成功！")}).catch(e=>{a.error("插入数据失败！"),console.error("保存修改失败:",e)})},Alter(t){D.Edit(t).then(e=>{console.log("修改保存成功:",e.data),a.success("修改数据成功！")}).catch(e=>{a.error("修改数据失败！"),console.error("保存修改失败:",e)})},Del(t){V.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{D.Del(t.id).then(e=>{const p=this.tableData.findIndex(C=>C.id===t.id);p!==-1&&this.tableData.splice(p,1),console.log("删除成功:",e.data),a.success("删除成功！")}).catch(e=>{a.error(response.msg),console.error("删除失败:",e)})}).catch(()=>{})},delND(t){V.confirm("确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=this.tableData.findIndex(p=>p.id===t.id);e!==-1&&this.tableData.splice(e,1),a.success("删除成功！")}).catch(()=>{a.error("删除失败！"),console.log("取消删除 API",t)})},addAPI(){a.success("添加数据ing");const t={id:0,memberId:0,memberPhone:"",productId:0,productName:"",sendTime:"",subscribeTime:"",isNew:!0};this.tableData.push(t);const e=Math.ceil(this.tableData.length/this.pageSize);this.handlePageChange(e)}},created(){this.fetchData()}},le={slot:"footer"};function oe(t,e,p,C,s,i){const c=M,r=J,x=I("Position"),m=K,d=W,k=I("EditPen"),P=I("Delete"),v=H,w=G,u=j,N=R,B=O,S=L,z=I("CirclePlusFilled");return h(),U("div",null,[l(c,{modelValue:s.searchText,"onUpdate:modelValue":e[0]||(e[0]=o=>s.searchText=o),placeholder:"请输入搜索关键字",clearable:"",onClear:t.clearSearch,onKeyup:q(t.performSearch,["enter"]),style:{"margin-bottom":"20px"}},null,8,["modelValue","onClear","onKeyup"]),l(v,{data:i.paginatedData,"header-cell-style":{background:"#eef1f6",color:"#606266"},borde:""},{default:n(()=>[l(r,{prop:"id",label:"Items"}),l(r,{prop:"memberId",label:"会员id"}),l(r,{prop:"memberPhone",label:"会员电话"}),l(r,{prop:"productId",label:"工厂id"}),l(r,{prop:"productName",label:"工厂名"}),l(r,{prop:"sendTime",label:"派发时间"}),l(r,{prop:"subscribeTime",label:"subscribeTime"}),l(r,{label:"操作"},{default:n(({row:o})=>[o.isNew?(h(),y(d,{key:0,class:"custom-button",type:"success",circle:"",onClick:_=>i.Insert(o)},{default:n(()=>[l(m,null,{default:n(()=>[l(x)]),_:1})]),_:2},1032,["onClick"])):(h(),y(d,{key:1,class:"custom-button",type:"warning",circle:"",onClick:_=>i.Alter(o)},{default:n(()=>[l(m,null,{default:n(()=>[l(x)]),_:1})]),_:2},1032,["onClick"])),l(d,{type:"primary",circle:"",onClick:_=>i.openEditDialog(o)},{default:n(()=>[l(m,null,{default:n(()=>[l(k)]),_:1})]),_:2},1032,["onClick"]),o.isNew?(h(),y(d,{key:2,type:"danger",circle:"",onClick:_=>i.delND(o)},{default:n(()=>[l(m,null,{default:n(()=>[l(P)]),_:1})]),_:2},1032,["onClick"])):(h(),y(d,{key:3,type:"danger",circle:"",onClick:_=>i.Del(o)},{default:n(()=>[l(m,null,{default:n(()=>[l(P)]),_:1})]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"]),l(w,{"current-page":s.currentPage,"page-size":s.pageSize,total:i.filteredtableData.length,onCurrentChange:i.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"]),l(S,{class:"form",modelValue:s.editDialogVisible,"onUpdate:modelValue":e[8]||(e[8]=o=>s.editDialogVisible=o),onClose:e[9]||(e[9]=o=>s.editDialogVisible=!1)},{default:n(()=>[l(B,null,{default:n(()=>[l(u,{label:"memberId"},{default:n(()=>[l(c,{modelValue:s.editItem.memberId,"onUpdate:modelValue":e[1]||(e[1]=o=>s.editItem.memberId=o)},null,8,["modelValue"])]),_:1}),l(u,{label:"memberPhone"},{default:n(()=>[l(c,{modelValue:s.editItem.memberPhone,"onUpdate:modelValue":e[2]||(e[2]=o=>s.editItem.memberPhone=o)},null,8,["modelValue"])]),_:1}),l(u,{label:"productId"},{default:n(()=>[l(N,{modelValue:s.editItem.productId,"onUpdate:modelValue":e[3]||(e[3]=o=>s.editItem.productId=o)},null,8,["modelValue"])]),_:1}),l(u,{label:"productName"},{default:n(()=>[l(c,{modelValue:s.editItem.productName,"onUpdate:modelValue":e[4]||(e[4]=o=>s.editItem.productName=o)},null,8,["modelValue"])]),_:1}),l(u,{label:"sendTime"},{default:n(()=>[l(c,{modelValue:s.editItem.sendTime,"onUpdate:modelValue":e[5]||(e[5]=o=>s.editItem.sendTime=o)},null,8,["modelValue"])]),_:1}),l(u,{label:"sensubscribeTimedTime"},{default:n(()=>[l(c,{modelValue:s.editItem.subscribeTime,"onUpdate:modelValue":e[6]||(e[6]=o=>s.editItem.subscribeTime=o)},null,8,["modelValue"])]),_:1})]),_:1}),F("div",le,[l(d,{onClick:e[7]||(e[7]=o=>s.editDialogVisible=!1)},{default:n(()=>[T("取消")]),_:1}),l(d,{type:"primary",onClick:i.saveEdit},{default:n(()=>[T("保存")]),_:1},8,["onClick"])])]),_:1},8,["modelValue"]),l(d,{type:"primary",circle:"",onClick:i.addAPI,style:{"margin-top":"10px"}},{default:n(()=>[l(m,null,{default:n(()=>[l(z)]),_:1})]),_:1},8,["onClick"])])}const he=A(te,[["render",oe]]);export{he as default};
